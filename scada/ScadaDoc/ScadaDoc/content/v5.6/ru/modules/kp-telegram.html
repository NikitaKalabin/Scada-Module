<!DOCTYPE html>
<html>
<head>
    <title>Драйвер Telegram - Документация Rapid SCADA</title>
    <meta charset="utf-8" />
    <link href="../../../../css/scadadoc.min.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="../../../../lib/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../js/contents.js"></script>
    <script type="text/javascript" src="../../../../js/scadadoc.js"></script>
</head>
<body>
    <h1>Драйвер Telegram</h1>
    <h2>Обзор</h2>
    <p>Драйвер Telegram предназначен для рассылки уведомлений пользователям с помощью популярного мессенджера Telegram. Преимуществами использования Telegram является оперативность получения уведомлений, отсутствие платы за использование сервиса и удобство управления группами рассылки.</p>

    <h2>Установка</h2>
    <p>Драйвер Telegram устанавливается в соответствии с <a href="../installation-and-run/module-installation.html#drivers">общей последовательностью установки драйверов Коммуникатора</a>. Файл библиотеки драйвера - KpTelegram.dll.</p>

    <h2>Конфигурирование</h2>
    <h3>Создание бота Telegram</h3>
    <p>Предварительно необходимо создать бота с системе Telegram. Для этого:</p>
    <ol>
        <li>Установите приложение и зарегистрируйтесь в <a href="https://telegram.org/" target="_blank">Telegram</a>.</li>
        <li>Добавьте в список контактов бота <a href="https://telegram.me/botfather" target="_blank">BotFather</a>.<br />
            <img src="kp-telegram-files/bot_father.png" alt="Telegram BotFather" class="sd-article-image border" /></li>
        <li>В режиме диалога с BotFather выполните команду /newbot и следуйте инструкциям от BotFather.</li>
        <li>Щёлкните по значку меню и создайте новую группу для получения рассылки.<br />
            <img src="kp-telegram-files/new_group.png" alt="Новая группа Telegram" class="sd-article-image border" /></li>
        <li>Добавьте созданного Вами бота в новую группу.</li>
        <li>Добавьте контакты в новую группу. Эти контакты будут получать рассылку.</li>
    </ol>

    <h3>Настройка драйвера</h3>
    <p>Настройка рассылки уведомлений выполняется в следующей последовательности:</p>
    <ol>
        <li>В программе Администратор открыть таблицу <em>Типы КП</em> и проверить, что тип КП 224 Telegram существует. Если указанная запись в таблице отсутствует, то ввести её вручную.</li>
        <li>В программе Администратор создать отдельную линию связи и единственный КП типа Telegram на данной линии связи.</li>
        <li>Импортировать созданную линию связи и КП в Коммуникатор. Разрешить отправку команд ТУ для линии связи.</li>
        <li>В Коммуникаторе открыть свойства КП, ввести токен бота, полученный при создании бота, и сгенерировать пароль бота, который используется для управления подписками.<br />
            <img src="kp-telegram-files/kp_telegram_config_ru.png" alt="Конфигурация КП Telegram" class="sd-article-image" /></li>
        <li>Перейти на страницу <em>Регистрация</em> и зарегистрировать драйвер, используя гиперссылки, размещённые на форме.<br />
            <img src="kp-telegram-files/kp_telegram_reg_ru.png" alt="Регистрация КП Telegram" class="sd-article-image" /></li>
        <li>Сохранить изменения конфигурации драйвера.</li>
        <li>Перезапустить службу Коммуникатора с помощью кнопки <img src="../../common-images/restart.png" />.</li>
    </ol>

    <h3>Управление подписками</h3>
    <p>Если настройка выполнена правильно, то Ваш бот будет отвечать на команды, например, команду /help</p>
    <p class="sd-article-image.border">
        <img src="kp-telegram-files/test_group_ru.png" alt="Группа уведомлений Telegram" /><br />
    </p>
    <p>Чтобы добавить или удалить подписку данной группы, используйте команды /start и /stop с указанием ранее сгенерированного пароля. Однако, по умолчанию изменение подписки заблокировано. Чтобы его разблокировать, в Коммуникаторе отправьте для КП стандартную команду номер 2 со значением 1. Теперь можно добавлять или удалять подписки.</p>

    <h2>Отправка сообщений</h2>
    <p>Чтобы из Rapid SCADA отправить сообщение в группу Telegram, необходимо отправить бинарную команду номер 1, содержащую имя (или идентификатор) группы и текст сообщения. Например: RapidScadaBotTestGroup; Тестовое сообщение.</p>
    <p class="sd-article-image">
        <img src="kp-telegram-files/send_cmd_ru.png" alt="Отправка сообщения Telegram" /><br />
    </p>
    <p>Автоматическая рассылка уведомлений при выполнении определённых условий и возникновении событий осуществляется с помощью <a href="mod-auto-control.html">Модуля автоматического управления.</a></p>
</body>
</html>
